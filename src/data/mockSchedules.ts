import { Schedule, DashboardStats } from '@/types/scheduling';

const today = new Date();
const tomorrow = new Date(today);
tomorrow.setDate(tomorrow.getDate() + 1);

export const mockSchedules: Schedule[] = [
  {
    id: '1',
    propertyId: 'mock-1',
    propertyName: 'Casa Vista Mar',
    propertyAddress: 'Rua das Flores, 123 - Florianópolis',
    guestName: 'Carlos Silva',
    numberOfGuests: 2,
    checkIn: new Date(today.setHours(14, 0, 0)),
    checkOut: new Date(today.setHours(11, 0, 0)),
    status: 'waiting',
    maintenanceStatus: 'ok',
    priority: 'high',
    cleanerName: 'Maria Silva',
    estimatedDuration: 120,
    checklist: [
      { id: '1', title: 'Limpar quartos', completed: false, category: 'Quartos' },
      { id: '2', title: 'Trocar roupas de cama', completed: false, category: 'Quartos' },
      { id: '3', title: 'Limpar banheiros', completed: false, category: 'Banheiros' },
      { id: '4', title: 'Repor amenities', completed: false, category: 'Banheiros' },
      { id: '5', title: 'Limpar cozinha', completed: false, category: 'Cozinha' },
      { id: '6', title: 'Verificar geladeira', completed: false, category: 'Cozinha' },
      { id: '7', title: 'Aspirar sala', completed: false, category: 'Sala' },
      { id: '8', title: 'Limpar varanda', completed: false, category: 'Área Externa' },
    ],
    photos: [],
    maintenanceIssues: [],
    notes: '',
    missingMaterials: [],
    ackByTeamMembers: [],
    history: [],
    isActive: true,
  },
  {
    id: '2',
    propertyId: 'mock-2',
    propertyName: 'Apartamento Centro',
    propertyAddress: 'Av. Beira Mar, 456 - Balneário Camboriú',
    guestName: 'Ana Rodrigues',
    numberOfGuests: 3,
    checkIn: new Date(today.setHours(15, 0, 0)),
    checkOut: new Date(today.setHours(10, 0, 0)),
    status: 'cleaning',
    maintenanceStatus: 'needs_maintenance',
    priority: 'high',
    cleanerName: 'João Santos',
    estimatedDuration: 90,
    checklist: [
      { id: '1', title: 'Limpar quartos', completed: true, category: 'Quartos' },
      { id: '2', title: 'Trocar roupas de cama', completed: true, category: 'Quartos' },
      { id: '3', title: 'Limpar banheiros', completed: false, category: 'Banheiros' },
      { id: '4', title: 'Repor amenities', completed: false, category: 'Banheiros' },
      { id: '5', title: 'Limpar cozinha', completed: false, category: 'Cozinha' },
      { id: '6', title: 'Aspirar sala', completed: false, category: 'Sala' },
    ],
    photos: [
      { id: '1', type: 'before', url: '/placeholder.svg', uploadedAt: new Date() },
    ],
    maintenanceIssues: [
      { id: '1', description: 'Torneira do banheiro vazando', severity: 'medium', reportedAt: new Date(), resolved: false },
    ],
    notes: 'Hóspede anterior relatou problema com ar condicionado',
    teamArrival: new Date(today.setHours(10, 30, 0)),
    missingMaterials: ['Sabonete líquido', 'Papel higiênico'],
    ackByTeamMembers: [],
    history: [],
    isActive: true,
    startAt: new Date(today.setHours(10, 30, 0)),
  },
  {
    id: '3',
    propertyId: 'mock-3',
    propertyName: 'Chalé da Montanha',
    propertyAddress: 'Estrada do Vale, 789 - Gramado',
    guestName: 'Pedro Oliveira',
    numberOfGuests: 4,
    checkIn: new Date(today.setHours(16, 0, 0)),
    checkOut: new Date(today.setHours(12, 0, 0)),
    status: 'released',
    maintenanceStatus: 'ok',
    priority: 'medium',
    cleanerName: 'Ana Costa',
    estimatedDuration: 150,
    checklist: [
      { id: '1', title: 'Limpar quartos', completed: true, category: 'Quartos' },
      { id: '2', title: 'Trocar roupas de cama', completed: true, category: 'Quartos' },
      { id: '3', title: 'Limpar banheiros', completed: true, category: 'Banheiros' },
      { id: '4', title: 'Repor amenities', completed: true, category: 'Banheiros' },
      { id: '5', title: 'Limpar cozinha', completed: true, category: 'Cozinha' },
      { id: '6', title: 'Acender lareira (verificar)', completed: true, category: 'Sala' },
      { id: '7', title: 'Limpar área externa', completed: true, category: 'Área Externa' },
    ],
    photos: [
      { id: '1', type: 'before', url: '/placeholder.svg', uploadedAt: new Date() },
      { id: '2', type: 'after', url: '/placeholder.svg', uploadedAt: new Date() },
    ],
    maintenanceIssues: [],
    notes: 'Limpeza profunda realizada',
    teamArrival: new Date(today.setHours(9, 0, 0)),
    teamDeparture: new Date(today.setHours(12, 30, 0)),
    missingMaterials: [],
    ackByTeamMembers: [],
    history: [],
    isActive: true,
  },
  {
    id: '4',
    propertyId: 'mock-4',
    propertyName: 'Cobertura Luxo',
    propertyAddress: 'Rua Principal, 100 - São Paulo',
    guestName: 'Mariana Costa',
    numberOfGuests: 2,
    checkIn: new Date(tomorrow.setHours(14, 0, 0)),
    checkOut: new Date(today.setHours(11, 0, 0)),
    status: 'completed',
    maintenanceStatus: 'ok',
    priority: 'low',
    cleanerName: 'Pedro Lima',
    estimatedDuration: 180,
    checklist: [
      { id: '1', title: 'Limpar quartos', completed: true, category: 'Quartos' },
      { id: '2', title: 'Trocar roupas de cama', completed: true, category: 'Quartos' },
      { id: '3', title: 'Limpar banheiros', completed: true, category: 'Banheiros' },
      { id: '4', title: 'Repor amenities', completed: true, category: 'Banheiros' },
      { id: '5', title: 'Limpar cozinha', completed: true, category: 'Cozinha' },
      { id: '6', title: 'Aspirar todos os ambientes', completed: true, category: 'Geral' },
      { id: '7', title: 'Limpar piscina', completed: true, category: 'Área Externa' },
      { id: '8', title: 'Organizar terraço', completed: true, category: 'Área Externa' },
    ],
    photos: [
      { id: '1', type: 'before', url: '/placeholder.svg', uploadedAt: new Date() },
      { id: '2', type: 'after', url: '/placeholder.svg', uploadedAt: new Date() },
    ],
    maintenanceIssues: [],
    notes: 'Tudo em ordem',
    teamArrival: new Date(today.setHours(8, 0, 0)),
    teamDeparture: new Date(today.setHours(11, 0, 0)),
    missingMaterials: [],
    ackByTeamMembers: [],
    history: [],
    isActive: true,
    startAt: new Date(today.setHours(8, 0, 0)),
    endAt: new Date(today.setHours(11, 0, 0)),
  },
  {
    id: '5',
    propertyId: 'mock-5',
    propertyName: 'Studio Praia',
    propertyAddress: 'Av. Atlântica, 200 - Rio de Janeiro',
    guestName: 'Lucas Ferreira',
    numberOfGuests: 1,
    checkIn: new Date(today.setHours(17, 0, 0)),
    checkOut: new Date(today.setHours(13, 0, 0)),
    status: 'waiting',
    maintenanceStatus: 'in_progress',
    priority: 'medium',
    cleanerName: 'Carla Mendes',
    estimatedDuration: 60,
    checklist: [
      { id: '1', title: 'Limpar quarto', completed: false, category: 'Quartos' },
      { id: '2', title: 'Trocar roupas de cama', completed: false, category: 'Quartos' },
      { id: '3', title: 'Limpar banheiro', completed: false, category: 'Banheiros' },
      { id: '4', title: 'Limpar kitchenette', completed: false, category: 'Cozinha' },
    ],
    photos: [],
    maintenanceIssues: [
      { id: '1', description: 'Ar condicionado com defeito', severity: 'high', reportedAt: new Date(), resolved: false },
    ],
    notes: 'Aguardando técnico do ar condicionado',
    missingMaterials: [],
    ackByTeamMembers: [],
    history: [],
    isActive: true,
  },
];

export const calculateStats = (schedules: Schedule[]): DashboardStats => {
  const now = new Date();
  
  // Delayed: 'waiting' or 'released' (cleaning not started) and check-in within 1 hour
  const delayed = schedules.filter(s => {
    if (s.status !== 'waiting' && s.status !== 'released') return false;
    const checkInTime = s.checkIn;
    const oneHourFromNow = new Date(now.getTime() + 60 * 60 * 1000);
    return checkInTime <= oneHourFromNow;
  }).length;

  return {
    waiting: schedules.filter(s => s.status === 'waiting').length,
    released: schedules.filter(s => s.status === 'released').length,
    cleaning: schedules.filter(s => s.status === 'cleaning').length,
    completed: schedules.filter(s => s.status === 'completed').length,
    maintenanceAlerts: schedules.filter(s => s.maintenanceStatus !== 'ok').length,
    delayed,
  };
};
